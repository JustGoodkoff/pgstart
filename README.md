# **Тестовое задание на позицию стажера QA в Postgres Pro**

## Задание 1
### План
#### 1. Недели 1-2 (до альфа-версии)
1. Поскольку я только пришел на проект, сначала изучу требования, юз-кейсы и юзер стори, макеты дизайна.
2. Настрою окружение и инфраструктуру.
3. Проверю доступность тестовой среды.
4. Подготовлю черновые версии тест-кейсов, чек-листов, плана тестирования. 
5. Создам тестовые данные для каталога, пользовательские аккаунты.
6. Составлю стратегию и план тестирования после выхода альфа-версии.
#### 2. Недели 3-4
1. Проведу дымовое тестирование альфа-версии, используя составленные чек-листы. Применю технику тест дизайна Use Case Testing.
2. Начну проводить функциональное тестирование, проведу модульное тестирование.
3. Зафиксирую дефекты (баг-репорт), приоритизирую, оценю трудозатраты, заведу задачи на доработки. 
4. Продолжу проверку разрабатываемого функционала.
5. Продолжу формировать тестовую документацию (тест-кейсы, чек-листы). 

#### 3. Недели 5-9
1. Предполагается, что к этому моменту ошибки альфа версии исправлены, идет активная разработка новых фич. 
2. Проведу тестирование новых функций, интеграционное тестирование с внешним сервисом оплаты и сервисом доставки (API-тестирование, mock-сервисы).
3. Начну автоматизировать тесты, интегрирую их в CI/CD.
4. По мере реализации функционала буду проводить регрессионное тестирование.
5. Зафиксирую дефекты.
6. Обновлю тестовую документацию, тест-кейсы, чек-листы.

#### Недели 10-11 
1. По-хорошему, к этому сроку реализация основной функциональности должна быть готова. 
2. В рамках этого этапа буду проводить нефункциональное тестирование: тестирование производительности, отказоустойчивости, восстановление и т.д.
3. Проведу end-to-end тестирование, настрою боевую(подобную) среду. Дополню тестовые данные. Проверю сквозные сценарии.
4. Проведу тестирование безопасности, оценку уязвимости/защищенности, фаззинг-тестирование, проверю соответствие критериям приемки.
5. При наличии дефектов составлю баг-репорты с высокой степенью приоритизации, по исправлению проведу регрессионное тестирование. 

#### Неделя 12
1. Проведу финальное регрессионное тестирование, проверю критические сценарии.
2. Вместе с командой проведу демонстрацию продукта, в рамках проверки требований используем чек-листы.
3. Проведу приемочное тестирование, соберу обратную связь. 
4. Подготовлю документ с основными данными по тестированию: покрытие, дефекты, процент автоматизации, процент прохождения тестов.

#### Недели 13-16
1. Мониторинг обратной связи, формирование баг-репортов, анализ логов.
2. При наличии тех.долга, проверка доработок, регрессионное тестирование.

В рамках каждого из этапов (кроме первого), будут собираться метрики тестирования (покрытие выполненных кейсов, успешные тест-кейсы, неуспешные тест-кейсы).

При управлении рисками нужно будет учесть: зависимость от сторонних сервисов, возможную низкую производительность и уязвимости безопасности. Для избежания этого проводится интеграционное, нагрузочное тестирование и тестирование безопасности. 

## Задание 2

### Установка PostgreSQL
PostgreSQL устанавливается в Docker путем скачивания образа:

```bash
docker pull postgres
```

### Создание и заполнение таблиц
Далее запускается контейнер, создается БД academy
```bash
docker run --name test-pg -p 5432:5432 -e POSTGRES_USER=agudkov -e POSTGRES_PASSWORD=testpg -e POSTGRES_DB=academy -d postgres
```

Для создания и заполнения таблиц выполняются скрипты 
```sql
-- Создание, файл init_tables.sql
CREATE TABLE Students (
    s_id        SERIAL PRIMARY KEY,
    name        VARCHAR(100) NOT NULL CHECK (LENGTH(name) > 0),
    start_year  INT NOT NULL CHECK (start_year <= EXTRACT(YEAR FROM CURRENT_DATE))
);

CREATE TABLE Courses (
    c_no    SERIAL PRIMARY KEY,
    title   VARCHAR(100) NOT NULL UNIQUE CHECK (LENGTH(title) > 0),
    hours   INT NOT NULL CHECK (hours > 0)
);

CREATE TABLE Exams (
    s_id    INT NOT NULL,
    c_no    INT NOT NULL,
    score   INTEGER NOT NULL CHECK (score BETWEEN 2 AND 5),
    
    PRIMARY KEY (s_id, c_no),
    FOREIGN KEY (s_id) REFERENCES Students(s_id) ON DELETE CASCADE,
    FOREIGN KEY (c_no) REFERENCES Courses(c_no) ON DELETE CASCADE
);
```

```sql
-- Заполнение, файл fill_tables.sql
BEGIN;
INSERT INTO Students (name, start_year) VALUES
    ('Иванов Иван Иванович', 2025),
    ('Петров Петр Петрович', 2024),
    ('Александров Александр Александрович', 2023);

INSERT INTO Courses (title, hours) VALUES
    ('Операционные системы', 10),
    ('Сетевые технологии', 20),
    ('ООП на Java', 30);

INSERT INTO Exams (s_id, c_no, score) VALUES
    (1, 1, 5),
    (1, 2, 4),
    (1, 3, 3),
    (2, 1, 3),
    (2, 2, 4),
    (2, 3, 2),
    (3, 1, 5),
    (3, 2, 5),
    (3, 3, 4);
COMMIT;
```

Сначала я копировал скрипты в контейнер, а затем запустил:
```bash
docker cp init_tables.sql test-pg:/init_tables.sql
docker cp fill_tables.sql test-pg:/fill_tables.sql

docker exec -it test-pg psql -U agudkov -d academy -f /init_tables.sql
docker exec -it test-pg psql -U agudkov -d academy -f /fill_tables.sql
```

### Запросы
1. **Запрос, который возвращает всех студентов, которые еще не сдали ни одного экзамена.**
```sql
SELECT 
    s.s_id,
    s.name,
    s.start_year
FROM Students s
LEFT JOIN Exams e ON s.s_id = e.s_id
WHERE e.s_id IS NULL;
```
2. **Запрос, который возвращает список студентов и количество сданных им экзаменов. Только для студентов, у которых есть сданные экзамены.**
```sql
SELECT 
    s.s_id,
    s.name,
    COUNT(e.s_id) AS exam_count
FROM Students s
JOIN Exams e ON s.s_id = e.s_id
GROUP BY s.s_id, s.name;
```

3. **Запрос, который выведет список курсов со средним баллом по экзамену. Список отсортирован по убыванию среднего балла.**
```sql
SELECT 
    c.c_no,
    c.title,
    ROUND(AVG(e.score), 2) AS avg_score
FROM Courses c
LEFT JOIN Exams e ON c.c_no = e.c_no
GROUP BY c.c_no, c.title
ORDER BY avg_score DESC;
```

### Комментарий
Создание, заполнение таблиц, корректность работы запросов проверял через терминал psql:
```bash
docker exec -it test-pg psql -U agudkov -d academy
```
После подключение в ней можно запускать запросы.
